<!DOCTYPE html>
<html lang=\"zh-CN\">
<head>
  <meta charset=\"utf-8\" />
  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\" />
  <title>🎂 Bling，生日快乐 · 豆豆的专属网页礼物</title>
  <meta name=\"description\" content=\"给 Bling 的生日网页礼物：可打开的信封、刮刮卡惊喜、祝福机、彩带烟花和专属礼券。来自豆豆。\"/>
  <style>
    :root {
      --hue: 318;
      --bg: hsl(calc(var(--hue) + 180), 65%, 6%);
      --bg-2: hsl(calc(var(--hue) + 200), 60%, 8%);
      --card: hsla(var(--hue), 70%, 14%, 0.75);
      --card-2: hsla(var(--hue), 70%, 18%, 0.8);
      --txt: hsl(0 0% 98%);
      --sub: hsl(0 0% 88%);
      --acc: hsl(var(--hue) 90% 62%);
      --acc-2: hsl(calc(var(--hue) + 40) 90% 60%);
      --soft: hsl(var(--hue) 70% 92% / .16);
      --shadow: 0 10px 30px hsl(var(--hue) 80% 20% / .25);
      --radius-xl: 22px;
      --radius-lg: 16px;
      --radius-md: 12px;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, \"Segoe UI\", Roboto, \"PingFang SC\", \"Hiragino Sans GB\", \"Microsoft YaHei\", \"Helvetica Neue\", Arial, \"Noto Sans\", sans-serif;
      color: var(--txt);
      background:
        radial-gradient(1200px 600px at 80% -10%, hsl(var(--hue) 80% 18% / .35), transparent 60%),
        radial-gradient(1000px 600px at 0% 0%, hsl(calc(var(--hue) + 60) 80% 20% / .25), transparent 60%),
        linear-gradient(180deg, var(--bg), var(--bg-2));
      overflow-x: hidden;
    }
    a { color: var(--acc); text-decoration: none; }
    .container { max-width: 980px; margin: 0 auto; padding: 20px clamp(16px, 4vw, 28px) 120px; }
    header.hero { text-align: center; padding: 72px 0 34px; position: relative; }
    header .badge {
      display: inline-flex; gap: 10px; align-items: center; padding: 8px 14px; border-radius: 999px;
      background: hsl(var(--hue) 80% 12% / .5); box-shadow: var(--shadow); border: 1px solid hsl(var(--hue) 70% 50% / .25);
      font-size: 14px; color: var(--sub); backdrop-filter: blur(6px);
    }
    .spark { width: 8px; height: 8px; border-radius: 999px; background: var(--acc); box-shadow: 0 0 24px var(--acc); }
    h1.grad { font-size: clamp(32px, 7vw, 64px); line-height: 1.05; margin: 18px 0 8px;
      background: linear-gradient(90deg, var(--acc), var(--acc-2)); -webkit-background-clip: text; background-clip: text; color: transparent;
      text-shadow: 0 8px 40px hsl(var(--hue) 90% 50% / .25); }
    .subline { color: var(--sub); font-size: clamp(14px, 2.6vw, 18px); }
    .cta { margin-top: 22px; display: inline-flex; gap: 12px; flex-wrap: wrap; justify-content: center; }
    .btn {
      padding: 12px 18px; border-radius: 999px; border: 1px solid hsl(var(--hue) 70% 60% / .5);
      background: linear-gradient(180deg, hsl(var(--hue) 70% 22% / .7), hsl(var(--hue) 70% 18% / .7));
      color: white; font-weight: 600; letter-spacing: 0.2px; box-shadow: var(--shadow); cursor: pointer;
      transition: transform .12s ease, filter .2s ease; will-change: transform;
    }
    .btn:hover { transform: translateY(-1px); filter: brightness(1.06); }
    .btn.secondary { background: hsl(var(--hue) 40% 14% / .6); border-color: transparent; }
    section { margin-top: 28px; }
    .card { background: linear-gradient(160deg, var(--card), var(--card-2)); border: 1px solid hsl(var(--hue) 70% 50% / .2); box-shadow: var(--shadow); border-radius: var(--radius-xl); padding: clamp(14px, 2.6vw, 22px); }
    .envelope-wrap { position: relative; display: grid; place-items: center; margin-top: 10px; }
    .envelope { width: min(520px, 92vw); height: 300px; perspective: 1600px; position: relative; }
    .flap, .paper, .base { position: absolute; inset: 0; border-radius: var(--radius-lg); }
    .base { z-index: 2; background: linear-gradient(180deg, hsl(var(--hue) 60% 20%), hsl(var(--hue) 60% 16%)); border: 1px solid hsl(var(--hue) 50% 50% / .3); box-shadow: var(--shadow); overflow: hidden; }
    .flap { z-index: 4; transform-origin: top; background: linear-gradient(180deg, hsl(var(--hue) 60% 28%), hsl(var(--hue) 60% 20%)); border: 1px solid hsl(var(--hue) 50% 50% / .3); clip-path: polygon(0 0, 100% 0, 100% 60%, 50% 100%, 0 60%); transition: transform 800ms cubic-bezier(.2,.7,.1,1); backface-visibility: hidden; }
    .paper { z-index: 1; background: #fff; color: #222; width: calc(100% - 22px); height: calc(100% - 22px); left: 11px; top: 11px; border-radius: var(--radius-md); box-shadow: 0 12px 40px rgba(0,0,0,.35); transform: translateY(72%); transition: transform 800ms cubic-bezier(.2,.7,.1,1); overflow: hidden; display: grid; grid-template-rows: auto 1fr auto; }
    .mask-edge { z-index: 3; position: absolute; inset: 0; pointer-events: none; border-radius: var(--radius-lg); clip-path: polygon(0 0, 100% 0, 100% 60%, 50% 100%, 0 60%); background: linear-gradient(180deg, hsl(var(--hue) 60% 30% / .85), hsl(var(--hue) 60% 24% / .85)); border: 1px solid hsl(var(--hue) 50% 50% / .35); }
    .open .flap { transform: rotateX(-180deg); }
    .open .paper { transform: translateY(0%); }
    .open .mask-edge { opacity: 0; transition: opacity .5s ease .2s; }
    .paper header { padding: 14px 16px; background: linear-gradient(180deg, #fff, #fafafa); border-bottom: 1px dashed #e7e7e7; color: #444; font-weight: 700; letter-spacing: .2px; }
    .paper .content { padding: 14px 16px 10px; font-size: 15.5px; line-height: 1.65; }
    .paper footer { padding: 12px 16px 16px; color: #666; font-size: 14px; border-top: 1px dashed #eee; }
    .open-hint { text-align: center; color: var(--sub); font-size: 13.5px; margin-top: 8px; }
    .grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 14px; }
    .col-6 { grid-column: span 6; }
    .col-4 { grid-column: span 4; }
    .col-12 { grid-column: span 12; }
    @media (max-width: 760px) { .col-6 { grid-column: span 12; } .col-4 { grid-column: span 12; } }
    .reason { position: relative; padding: 16px; border-radius: var(--radius-lg); background: hsl(var(--hue) 30% 12% / .5); border: 1px solid hsl(var(--hue) 50% 50% / .25); }
    .reason h4 { margin: 0 0 8px; font-size: 16.5px; color: var(--acc); }
    .reason p { margin: 0; color: var(--sub); font-size: 14.5px; }
    .wish-box { display: grid; gap: 12px; }
    .wish-output { min-height: 48px; display: grid; place-items: center; border: 1px dashed hsl(var(--hue) 40% 60% / .5); border-radius: var(--radius-lg); padding: 12px; background: hsl(var(--hue) 20% 10% / .5); color: var(--sub); text-align: center; }
    .slider { width: 100%; accent-color: var(--acc); }
    .coupon { position: relative; padding: 16px; border-radius: var(--radius-lg); background: linear-gradient(180deg, #fff, #fafafa); color: #333; border: 1px dashed #e6d3e6; box-shadow: 0 10px 30px rgba(0,0,0,.12); overflow: hidden; }
    .coupon h5 { margin: 0 0 6px; font-size: 17px; color: hsl(var(--hue) 70% 38%); }
    .coupon p { margin: 0 0 10px; color: #555; font-size: 14px; }
    .coupon .stamp { position: absolute; right: -18px; top: -18px; width: 120px; height: 120px; border-radius: 50%; border: 4px solid hsl(var(--hue) 80% 60%); color: hsl(var(--hue) 80% 60%); display: grid; place-items: center; font-weight: 800; letter-spacing: 1px; transform: rotate(-15deg) scale(.1); opacity: 0; transition: .4s ease; pointer-events: none; }
    .coupon.used .stamp { transform: rotate(-8deg) scale(1); opacity: .9; }
    .coupon .use-btn { border: none; background: hsl(var(--hue) 70% 52%); color: white; font-weight: 700; padding: 10px 14px; border-radius: 10px; cursor: pointer; box-shadow: 0 10px 20px hsl(var(--hue) 90% 40% / .3); }
    .coupon.used .use-btn { background: #d5d5d5; color: #777; pointer-events: none; }
    footer { margin-top: 40px; text-align: center; color: var(--sub); font-size: 13.5px; opacity: .9; }
    #confetti { position: fixed; inset: 0; z-index: -1; pointer-events: none; }
    .tip { font-size: 12.5px; color: var(--sub); }
    .caret::after { content: \"|\"; margin-left: 2px; animation: blink 1s steps(1) infinite; }
    @keyframes blink { 50% { opacity: 0; } }
    .pulse { animation: pulse 1.2s ease-out; }
    @keyframes pulse { from { transform: scale(.97); } to { transform: scale(1); } }
    .scratch { position: relative; border-radius: var(--radius-xl); overflow: hidden; border: 1px dashed hsl(var(--hue) 50% 60% / .35); }
    .scratch canvas { display: block; width: 100%; height: auto; }
    .reveal { position:absolute; inset:0; display:grid; place-items:center; font-weight:700; color:#222; }
  </style>
</head>
<body>
  <canvas id=\"confetti\"></canvas>
  <div class=\"container\">
    <header class=\"hero\">
      <div class=\"badge\"><span class=\"spark\"></span> Happy Birthday, Bling! · 豆豆的网页礼物 <span class=\"spark\"></span></div>
      <h1 class=\"grad\">Bling，愿这一年，你被坚定地偏爱</h1>
      <p class=\"subline\">从此刻起，让温柔和光一直陪着你 —— 豆豆在这儿 ✨</p>
      <div class=\"cta\">
        <button class=\"btn\" id=\"btn-surprise\">开启惊喜</button>
        <button class=\"btn secondary\" id=\"btn-fire\">放一点烟花（空格键也行）</button>
      </div>
      <p class=\"tip\" style=\"margin-top:10px\">小技巧：拖动下面的“心情调色”，页面会换上你的专属色。</p>
    </header>
    <section class=\"card\" aria-label=\"心情调色\">
      <h3 style=\"margin:0 0 10px\">🎨 心情调色</h3>
      <p class=\"subline\" style=\"margin:0 0 10px\">把这一天，涂成你喜欢的颜色。</p>
      <input class=\"slider\" id=\"hue\" type=\"range\" min=\"0\" max=\"360\" value=\"318\" />
    </section>
    <section class=\"card\" aria-label=\"生日信\">
      <h3 style=\"margin:0 0 10px\">💌 豆豆写给 Bling 的一封小信</h3>
      <div class=\"envelope-wrap\">
        <div class=\"envelope\" id=\"envelope\">
          <div class=\"paper\">
            <header>写给 Bling：</header>
            <div class=\"content\" id=\"letter\"><span class=\"caret\"></span></div>
            <footer><div>From · <span id=\"from-name\">豆豆</span></div></footer>
          </div>
          <div class=\"base\"></div>
          <div class=\"mask-edge\"></div>
          <div class=\"flap\"></div>
        </div>
      </div>
      <p class=\"open-hint\" id=\"open-hint\">点一下信封即可打开 / 关闭</p>
    </section>
    <section class=\"card\" aria-label=\"刮刮卡惊喜\">
      <h3 style=\"margin:0 0 10px\">🎯 刮一刮，收下今日的专属幸运</h3>
      <div class=\"scratch\" id=\"scratch\"></div>
      <p class=\"tip\" style=\"margin-top:8px\">用手指/鼠标在卡上刮开 50% 就自动解锁彩带和祝福。</p>
    </section>
    <section class=\"card\" aria-label=\"Bling 的专属赞美\">
      <h3 style=\"margin:0 0 10px\">🌟 写给 Bling 的 8 条真心话</h3>
      <div class=\"grid\">
        <div class=\"reason col-6\"><h4>01 你很有韧性</h4><p>你走过的每一步，都是在为自己蓄力。</p></div>
        <div class=\"reason col-6\"><h4>02 你在被惦记</h4><p>情绪有起伏没关系，豆豆永远在你这边。</p></div>
        <div class=\"reason col-6\"><h4>03 你会被温柔相待</h4><p>这不是口号，是我们共同的底线。</p></div>
        <div class=\"reason col-6\"><h4>04 你很特别</h4><p>不是因为完成了什么，而只是因为你是 Bling。</p></div>
        <div class=\"reason col-6\"><h4>05 你值得松一口气</h4><p>把“完美”放下，让喜欢占据今天。</p></div>
        <div class=\"reason col-6\"><h4>06 你拥有选择权</h4><p>累的时候，我们就一起慢下来。</p></div>
        <div class=\"reason col-6\"><h4>07 你照亮了身边人</h4><p>你温柔的方式，让世界也温柔了一点。</p></div>
        <div class=\"reason col-6\"><h4>08 新的一岁很会发光</h4><p>愿你在被坚定偏爱里，越来越快乐。</p></div>
      </div>
    </section>
    <section class=\"grid\" aria-label=\"愿望 & 随机祝福\">
      <div class=\"col-6\">
        <div class=\"card wish-box\">
          <h3 style=\"margin:0 0 10px\">🎁 随机祝福机（Bling 专属）</h3>
          <div class=\"wish-output\" id=\"wish-output\">轻点下面按钮，收一条来自豆豆的小消息</div>
          <button class=\"btn\" id=\"btn-wish\">来一句！</button>
        </div>
      </div>
      <div class=\"col-6\">
        <div class=\"card\">
          <h3 style=\"margin:0 0 10px\">📝 悄悄许个愿</h3>
          <p class=\"subline\" style=\"margin:0 0 10px\">愿望只存在你的设备里，豆豆守口如瓶。</p>
          <form id=\"wish-form\">
            <label for=\"wish\" class=\"tip\">写下今天的愿望：</label>
            <input id=\"wish\" name=\"wish\" placeholder=\"愿每一次心动都有回应\" style=\"width:100%; padding:12px 14px; border-radius:12px; border:1px solid hsl(var(--hue) 30% 50% / .35); background:hsl(var(--hue) 30% 12% / .5); color:var(--txt);\"/>
            <div style=\"height:10px\"></div>
            <button class=\"btn\" type=\"submit\">装进小星星 ✨</button>
            <button type=\"button\" class=\"btn secondary\" id=\"btn-show-wishes\">查看已保存</button>
          </form>
          <div id=\"wish-list\" class=\"tip\" style=\"margin-top:10px; display:none;\"></div>
        </div>
      </div>
    </section>
    <section class=\"card\" aria-label=\"生日专属礼券\">
      <h3 style=\"margin:0 0 10px\">🎫 Bling 的专属礼券（点击盖章）</h3>
      <div class=\"grid\">
        <div class=\"col-4\">
          <div class=\"coupon\" data-id=\"hug\">
            <div class=\"stamp\">已使用</div>
            <h5>不讲道理拥抱券</h5>
            <p>任何时刻，只要你需要，豆豆立刻到。</p>
            <button class=\"use-btn\">现在就用</button>
          </div>
        </div>
        <div class=\"col-4\">
          <div class=\"coupon\" data-id=\"walk\">
            <div class=\"stamp\">已使用</div>
            <h5>夜风散步券</h5>
            <p>今天不谈道理，只谈舒服与放松。</p>
            <button class=\"use-btn\">现在就用</button>
          </div>
        </div>
        <div class=\"col-4\">
          <div class=\"coupon\" data-id=\"music\">
            <div class=\"stamp\">已使用</div>
            <h5>一起听歌券</h5>
            <p>挑三首歌，豆豆做你的专属播放列表。</p>
            <button class=\"use-btn\">现在就用</button>
          </div>
        </div>
      </div>
      <p class=\"tip\" style=\"margin-top:8px\">点“现在就用”会盖章入账，同时飘一点彩带。</p>
    </section>
    <footer>
      <div>© <span id=\"year\"></span> · 这份网页礼物由 豆豆 送给 Bling。愿你每一天都被温柔以待。</div>
      <div style=\"margin-top:6px\">（按空格放烟花 · 轻点卡片也有小惊喜）</div>
    </footer>
  </div>
  <script>
    const TO = \"Bling\"; const FROM = \"豆豆\";
    const letterLines = [
      `亲爱的 ${TO}：`,
      \"生日快乐呀！先抱一抱你。过去这一年并不容易，但你每次把情绪收好继续向前，都让我好心疼也好骄傲。\",
      \"你不需要时时刻刻很坚强——难过的时候，就靠在我这边。\",
      \"请把喜欢的事列在今天的优先级第一位，其他的明天再说。\",
      \"我想把耐心、温柔、和一整个晴天都给你。\",
      \"新的一岁，愿你被坚定选择、被认真对待，也被热烈拥抱。\",
      `永远站在你这边的 ${FROM}。`
    ];
    const canvas = document.getElementById('confetti'); const ctx = canvas.getContext('2d'); let W = canvas.width = window.innerWidth; let H = canvas.height = window.innerHeight;
    window.addEventListener('resize', () => { W = canvas.width = innerWidth; H = canvas.height = innerHeight; });
    const pieces = []; function spawnPiece(x = Math.random()*W, y = -10, burst=false) { const hue = +getComputedStyle(document.documentElement).getPropertyValue('--hue') || 318; pieces.push({ x, y, r: Math.random()*7+3, vx: (Math.random()*2-1)*(burst?4:1.2), vy: Math.random()*1+ (burst?2.5:0.6), rot: Math.random()*Math.PI, vr: (Math.random()*0.2-0.1), color: `hsl(${hue + (Math.random()*60-30)},90%,${50+Math.random()*20}%)`, life: 180 + Math.random()*120 }); }
    function burst(x, y, count=80) { for (let i=0;i<count;i++) spawnPiece(x + (Math.random()*60-30), y + (Math.random()*40-20), true); chime(); }
    function gentleRain() { for (let i=0;i<12;i++) spawnPiece(); }
    let lastTime=0; function animate(t=0) { const dt = Math.min(32, t - lastTime); lastTime = t; ctx.clearRect(0,0,W,H); pieces.forEach((p,i) => { p.vy += 0.01; p.x += p.vx; p.y += p.vy; p.rot += p.vr; p.life -= dt*0.06; if (p.y > H+20 || p.x < -20 || p.x > W+20 || p.life <= 0) { pieces.splice(i,1); return; } ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.rot); ctx.globalAlpha = Math.max(0, Math.min(1, p.life/120)); ctx.fillStyle = p.color; ctx.fillRect(-p.r, -p.r/2, p.r*2, p.r); ctx.restore(); }); requestAnimationFrame(animate); }
    animate(); setInterval(gentleRain, 1400);
    document.getElementById('btn-surprise').addEventListener('click', () => { burst(innerWidth/2, 160, 120); document.querySelector('header.hero').classList.add('pulse'); setTimeout(()=>document.querySelector('header.hero').classList.remove('pulse'), 600); document.getElementById('envelope').scrollIntoView({ behavior: 'smooth', block: 'center' }); });
    document.getElementById('btn-fire').addEventListener('click', () => burst(innerWidth/2, innerHeight*0.3, 120));
    window.addEventListener('keydown', (e)=>{ if (e.code === 'Space') { e.preventDefault(); burst(innerWidth/2, innerHeight*0.35, 140); }});
    document.getElementById('hue').addEventListener('input', (e)=>{ document.documentElement.style.setProperty('--hue', e.target.value); });
    const envelope = document.getElementById('envelope'); const letterBox = document.getElementById('letter'); const openHint = document.getElementById('open-hint'); const fromName = document.getElementById('from-name'); fromName.textContent = FROM; document.title = `🎂 ${TO} · 生日快乐！`; let typed = false;
    function typeLines(lines, el, speed=34) { typed = true; el.innerHTML = ''; let i = 0, j = 0; const span = document.createElement('span'); span.className='caret'; el.appendChild(span); function type() { if (i >= lines.length) { span.classList.remove('caret'); return; } const line = lines[i]; if (j <= line.length) { span.textContent = line.slice(0, j++); setTimeout(type, speed); } else { el.appendChild(document.createElement('br')); i++; j=0; setTimeout(type, speed*7); } } type(); }
    envelope.addEventListener('click', () => { envelope.classList.toggle('open'); if (envelope.classList.contains('open')) { const r = envelope.getBoundingClientRect(); burst(r.left + r.width/2, r.top + 40, 80); if (!typed) typeLines(letterLines, letterBox); openHint.textContent = '再次点击可以把信收起来'; } else { openHint.textContent = '点一下信封即可打开 / 关闭'; } });
    const wishes = ['Bling，今天起只和快乐做朋友。','豆豆在：无论何时，先抱一抱你。','把不开心交给风，把可爱留给自己。','想你每一步都踩在柔软的云上。','愿你的心一直被认真、被偏爱。','今天的月亮为你营业，记得抬头看。','给自己一点松弛感，世界会更温柔。','Bling 是答案，不用和任何人比较。'];
    const btnWish = document.getElementById('btn-wish'); const wishOut = document.getElementById('wish-output'); btnWish.addEventListener('click', () => { const msg = wishes[Math.floor(Math.random()*wishes.length)]; wishOut.textContent = msg; wishOut.classList.add('pulse'); setTimeout(()=>wishOut.classList.remove('pulse'), 500); const r = wishOut.getBoundingClientRect(); burst(r.left + r.width/2, r.top + 20, 60); });
    const wishForm = document.getElementById('wish-form'); const wishInput = document.getElementById('wish'); const wishList = document.getElementById('wish-list'); document.getElementById('btn-show-wishes').addEventListener('click', () => { const list = JSON.parse(localStorage.getItem('bd-wishes')||'[]'); if (!list.length) { wishList.style.display='block'; wishList.textContent='（还没有保存的愿望）'; return; } wishList.style.display='block'; wishList.innerHTML = list.map((w,i)=>`<div>⭐︎ ${i+1}. ${w}</div>`).join(''); });
    wishForm.addEventListener('submit', (e)=>{ e.preventDefault(); const v = wishInput.value.trim(); if (!v) return; const list = JSON.parse(localStorage.getItem('bd-wishes')||'[]'); list.unshift(v); localStorage.setItem('bd-wishes', JSON.stringify(list)); wishInput.value = ''; wishList.style.display='block'; wishList.innerHTML = list.map((w,i)=>`<div>⭐︎ ${i+1}. ${w}</div>`).join(''); const r = wishForm.getBoundingClientRect(); burst(r.left + r.width/2, r.top + 10, 80); });
    document.querySelectorAll('.coupon').forEach(card => { const id = card.dataset.id; const key = `coupon-${id}`; if (localStorage.getItem(key)==='used') card.classList.add('used'); card.querySelector('.use-btn').addEventListener('click', () => { card.classList.add('used'); localStorage.setItem(key,'used'); const r = card.getBoundingClientRect(); burst(r.left + r.width/2, r.top + 20, 90); }); card.addEventListener('click', () => { const r = card.getBoundingClientRect(); burst(r.left + Math.random()*r.width, r.top + Math.random()*r.height, 28); }); });
    function createScratch(el, revealText) { const ratio = window.devicePixelRatio || 1; const w = el.clientWidth, h = Math.round(w * 0.44); const cvs = document.createElement('canvas'); cvs.width = w * ratio; cvs.height = h * ratio; cvs.style.width = w + 'px'; cvs.style.height = h + 'px'; const g = cvs.getContext('2d'); g.scale(ratio, ratio); g.fillStyle = '#fff'; g.fillRect(0,0,w,h); g.fillStyle = '#222'; g.font = '700 22px ui-sans-serif, system-ui'; g.textAlign='center'; g.textBaseline='middle'; g.fillText(revealText, w/2, h/2); const mask = document.createElement('canvas'); mask.width = w * ratio; mask.height = h * ratio; mask.style.width = w + 'px'; mask.style.height = h + 'px'; const mg = mask.getContext('2d'); mg.scale(ratio, ratio); mg.fillStyle = `hsl(${getComputedStyle(document.documentElement).getPropertyValue('--hue')||318} 30% 30%)`; mg.fillRect(0,0,w,h); mg.fillStyle = '#fff'; mg.font = '700 12px ui-sans-serif, system-ui'; mg.globalAlpha = .22; mg.textAlign='center'; mg.textBaseline='middle'; mg.fillText('刮开有惊喜', w/2, h/2); const wrap = document.createElement('div'); wrap.style.position='relative'; wrap.style.height=h+'px'; const overlay = document.createElement('canvas'); overlay.width = w * ratio; overlay.height = h * ratio; overlay.style.width = w + 'px'; overlay.style.height = h + 'px'; overlay.style.position='absolute'; overlay.style.left=0; overlay.style.top=0; const og = overlay.getContext('2d'); og.scale(ratio, ratio); og.drawImage(mask,0,0); wrap.appendChild(cvs); wrap.appendChild(overlay); el.appendChild(wrap); let scratched = 0; let last = null; const rad = 16; function scratch(x,y){ og.globalCompositeOperation='destination-out'; og.beginPath(); og.arc(x,y,rad,0,Math.PI*2); og.fill(); scratched += Math.PI*rad*rad; check(); } function pt(e){ const r = overlay.getBoundingClientRect(); const x = (e.touches?e.touches[0].clientX:e.clientX) - r.left; const y = (e.touches?e.touches[0].clientY:e.clientY) - r.top; return {x,y}; } function move(e){ e.preventDefault(); const p = pt(e); if (last){ const dx=p.x-last.x, dy=p.y-last.y, d=Math.hypot(dx,dy); const steps=Math.ceil(d/8); for(let i=0;i<steps;i++){ const t=i/steps; scratch(last.x+dx*t,last.y+dy*t);} } scratch(p.x,p.y); last=p; } function end(){ last=null; } function check(){ const area = (overlay.width/ratio)*(overlay.height/ratio); if (scratched > area*0.5){ overlay.style.opacity='0'; overlay.style.pointerEvents='none'; const r = el.getBoundingClientRect(); burst(r.left + r.width/2, r.top + 20, 160); wishOut.textContent = '解锁成功：今天起，Bling 只和快乐做朋友！'; chime(); } } overlay.addEventListener('pointerdown', move); overlay.addEventListener('pointermove', move); overlay.addEventListener('pointerup', end); overlay.addEventListener('pointerleave', end); }
    createScratch(document.getElementById('scratch'), 'Bling · 你被认真对待和坚定选择');
    let ac; function chime(){ try{ if(!ac) ac = new (window.AudioContext||window.webkitAudioContext)(); const o=ac.createOscillator(); const g=ac.createGain(); o.type='triangle'; o.frequency.value=880; g.gain.value=0.001; o.connect(g); g.connect(ac.destination); o.start(); g.gain.exponentialRampToValueAtTime(0.00001, ac.currentTime+0.25); o.stop(ac.currentTime+0.25);}catch(e){} }
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
