<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>ğŸ‚ ç»™Blingçš„ä¸“å±å°å®‡å®™ Â· ç”Ÿæ—¥å¿«ä¹ï¼</title>
  <meta name="description" content="ä¸€ä»½ä¸ºä½ å®šåˆ¶çš„ç½‘é¡µç¤¼ç‰©ï¼šä¿¡ä»¶ã€ç¥ç¦ã€ç¤¼åˆ¸å’Œå°å°çƒŸèŠ±ã€‚æ„¿ä½ ä»ä»Šå¤©èµ·ï¼Œå’Œå¿«ä¹æ’ä¸ªæ»¡æ€€ã€‚"/>
  <style>
    :root {
      --hue: 320;           /* ä¸»é¢˜è‰²ç›¸ï¼ˆ0-360 å¯è°ƒï¼‰ */
      --bg: hsl(calc(var(--hue) + 180), 65%, 6%);
      --bg-2: hsl(calc(var(--hue) + 200), 60%, 8%);
      --card: hsla(var(--hue), 70%, 14%, 0.7);
      --card-2: hsla(var(--hue), 70%, 18%, 0.75);
      --txt: hsl(0 0% 98%);
      --sub: hsl(0 0% 88%);
      --acc: hsl(var(--hue) 90% 62%);
      --acc-2: hsl(calc(var(--hue) + 40) 90% 60%);
      --soft: hsl(var(--hue) 70% 92% / .14);
      --shadow: 0 10px 30px hsl(var(--hue) 80% 20% / .25);
      --radius-xl: 22px;
      --radius-lg: 16px;
      --radius-md: 12px;
    }

    /* Reset & base */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      color: var(--txt);
      background:
        radial-gradient(1200px 600px at 80% -10%, hsl(var(--hue) 80% 18% / .35), transparent 60%),
        radial-gradient(1000px 600px at 0% 0%, hsl(calc(var(--hue) + 60) 80% 20% / .25), transparent 60%),
        linear-gradient(180deg, var(--bg), var(--bg-2));
      overflow-x: hidden;
    }
    a { color: var(--acc); text-decoration: none; }

    .container {
      max-width: 960px; margin: 0 auto; padding: 20px clamp(16px, 4vw, 28px) 120px;
    }

    header.hero {
      text-align: center; padding: 72px 0 34px; position: relative;
    }
    header .badge {
      display: inline-flex; gap: 10px; align-items: center; padding: 8px 14px; border-radius: 999px;
      background: hsl(var(--hue) 80% 12% / .5); box-shadow: var(--shadow); border: 1px solid hsl(var(--hue) 70% 50% / .25);
      font-size: 14px; color: var(--sub);
      backdrop-filter: blur(6px);
    }
    .spark { width: 8px; height: 8px; border-radius: 999px; background: var(--acc); box-shadow: 0 0 24px var(--acc); }

    h1.grad {
      font-size: clamp(32px, 7vw, 64px); line-height: 1.05; margin: 18px 0 8px;
      background: linear-gradient(90deg, var(--acc), var(--acc-2));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      text-shadow: 0 8px 40px hsl(var(--hue) 90% 50% / .25);
    }
    .subline { color: var(--sub); font-size: clamp(14px, 2.6vw, 18px); }

    .cta {
      margin-top: 22px; display: inline-flex; gap: 12px; flex-wrap: wrap; justify-content: center;
    }
    .btn {
      padding: 12px 18px; border-radius: 999px; border: 1px solid hsl(var(--hue) 70% 60% / .5);
      background: linear-gradient(180deg, hsl(var(--hue) 70% 22% / .7), hsl(var(--hue) 70% 18% / .7));
      color: white; font-weight: 600; letter-spacing: 0.2px; box-shadow: var(--shadow); cursor: pointer;
      transition: transform .12s ease, filter .2s ease;
      will-change: transform;
    }
    .btn:hover { transform: translateY(-1px); filter: brightness(1.06); }
    .btn.secondary { background: hsl(var(--hue) 40% 14% / .6); border-color: transparent; }

    /* Sections */
    section { margin-top: 28px; }
    .card {
      background: linear-gradient(160deg, var(--card), var(--card-2));
      border: 1px solid hsl(var(--hue) 70% 50% / .2);
      box-shadow: var(--shadow); border-radius: var(--radius-xl); padding: clamp(14px, 2.6vw, 22px);
    }

    /* Envelope letter */
    .envelope-wrap { position: relative; display: grid; place-items: center; margin-top: 10px; }
    .envelope { width: min(520px, 92vw); height: 280px; perspective: 1600px; }
    .flap, .paper, .base { position: absolute; inset: 0; border-radius: var(--radius-lg); }
    .base { background: linear-gradient(180deg, hsl(var(--hue) 60% 20%), hsl(var(--hue) 60% 16%)); border: 1px solid hsl(var(--hue) 50% 50% / .3); box-shadow: var(--shadow); }
    .flap { transform-origin: top; background: linear-gradient(180deg, hsl(var(--hue) 60% 28%), hsl(var(--hue) 60% 20%)); border: 1px solid hsl(var(--hue) 50% 50% / .3); clip-path: polygon(0 0, 100% 0, 100% 60%, 50% 100%, 0 60%); transition: transform 800ms cubic-bezier(.2,.7,.1,1); }
    .paper { background: #fff; color: #222; width: calc(100% - 22px); height: calc(100% - 22px); left: 11px; top: 11px; border-radius: var(--radius-md); box-shadow: 0 12px 40px rgba(0,0,0,.35);
      transform: translateY(46%); transition: transform 800ms cubic-bezier(.2,.7,.1,1); overflow: hidden; display: grid; grid-template-rows: auto 1fr auto; }
    .paper header { padding: 14px 16px; background: linear-gradient(180deg, #fff, #fafafa); border-bottom: 1px dashed #e7e7e7; color: #444; font-weight: 700; letter-spacing: .2px; }
    .paper .content { padding: 14px 16px 10px; font-size: 15.5px; line-height: 1.6; }
    .paper footer { padding: 12px 16px 16px; color: #666; font-size: 14px; border-top: 1px dashed #eee; }
    .open .flap { transform: rotateX(-180deg); }
    .open .paper { transform: translateY(0%); }
    .open-hint { text-align: center; color: var(--sub); font-size: 13.5px; margin-top: 8px; }

    /* Reasons grid */
    .grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 14px; }
    .col-6 { grid-column: span 6; }
    .col-4 { grid-column: span 4; }
    .col-12 { grid-column: span 12; }
    @media (max-width: 760px) { .col-6 { grid-column: span 12; } .col-4 { grid-column: span 12; } }

    .reason { position: relative; padding: 16px; border-radius: var(--radius-lg); background: hsl(var(--hue) 30% 12% / .5); border: 1px solid hsl(var(--hue) 50% 50% / .25); }
    .reason h4 { margin: 0 0 8px; font-size: 16.5px; color: var(--acc); }
    .reason p { margin: 0; color: var(--sub); font-size: 14.5px; }

    /* Wish machine */
    .wish-box { display: grid; gap: 12px; }
    .wish-output { min-height: 48px; display: grid; place-items: center; border: 1px dashed hsl(var(--hue) 40% 60% / .5); border-radius: var(--radius-lg); padding: 12px; background: hsl(var(--hue) 20% 10% / .5); color: var(--sub); text-align: center; }

    /* Mood color */
    .slider { width: 100%; accent-color: var(--acc); }

    /* Coupons */
    .coupon { position: relative; padding: 16px; border-radius: var(--radius-lg); background: linear-gradient(180deg, #fff, #fafafa); color: #333; border: 1px dashed #e6d3e6; box-shadow: 0 10px 30px rgba(0,0,0,.12); overflow: hidden; }
    .coupon h5 { margin: 0 0 6px; font-size: 17px; color: hsl(var(--hue) 70% 38%); }
    .coupon p { margin: 0 0 10px; color: #555; font-size: 14px; }
    .coupon .stamp { position: absolute; right: -18px; top: -18px; width: 120px; height: 120px; border-radius: 50%; border: 4px solid hsl(var(--hue) 80% 60%);
      color: hsl(var(--hue) 80% 60%); display: grid; place-items: center; font-weight: 800; letter-spacing: 1px; transform: rotate(-15deg) scale(.1); opacity: 0; transition: .4s ease; pointer-events: none; }
    .coupon.used .stamp { transform: rotate(-8deg) scale(1); opacity: .9; }
    .coupon .use-btn { border: none; background: hsl(var(--hue) 70% 52%); color: white; font-weight: 700; padding: 10px 14px; border-radius: 10px; cursor: pointer; box-shadow: 0 10px 20px hsl(var(--hue) 90% 40% / .3); }
    .coupon.used .use-btn { background: #d5d5d5; color: #777; pointer-events: none; }

    /* Footer */
    footer { margin-top: 40px; text-align: center; color: var(--sub); font-size: 13.5px; opacity: .9; }

    /* Confetti canvas */
    #confetti { position: fixed; inset: 0; z-index: -1; pointer-events: none; }

    /* Floating tips */
    .tip { font-size: 12.5px; color: var(--sub); }

    /* Typing caret */
    .caret::after { content: "|"; margin-left: 2px; animation: blink 1s steps(1) infinite; }
    @keyframes blink { 50% { opacity: 0; } }

    /* Micro pulse */
    .pulse { animation: pulse 1.2s ease-out; }
    @keyframes pulse { from { transform: scale(.97); } to { transform: scale(1); } }
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>
  <div class="container">
    <header class="hero">
      <div class="badge"><span class="spark"></span> Happy Birthday Â· é€ç»™ä½ çš„ä¸€ä»½å°å°ç½‘é¡µç¤¼ç‰© <span class="spark"></span></div>
      <h1 class="grad">æ„¿ä½ ä»Šå¤©è¢«çˆ±ä¸å¿«ä¹ç¯ç»•</h1>
      <p class="subline">ä»æ­¤åˆ»èµ·ï¼Œè®©æ¸©æŸ”å’Œå…‰ä¸€èµ·æ¥åˆ°ä½ èº«è¾¹â€”â€”ä¸å†ä½æ²‰å•¦ âœ¨</p>
      <div class="cta">
        <button class="btn" id="btn-surprise">å¼€å¯æƒŠå–œ</button>
        <button class="btn secondary" id="btn-fire">æ”¾ä¸€ç‚¹çƒŸèŠ±ï¼ˆç©ºæ ¼é”®ä¹Ÿè¡Œï¼‰</button>
      </div>
      <p class="tip" style="margin-top:10px">å°æŠ€å·§ï¼šæ‹–åŠ¨ä¸‹é¢çš„â€œå¿ƒæƒ…è°ƒè‰²â€ï¼Œé¡µé¢ä¼šæ¢ä¸Šä½ çš„ä¸“å±è‰²ã€‚</p>
    </header>

    <!-- Mood color section -->
    <section class="card" aria-label="å¿ƒæƒ…è°ƒè‰²">
      <h3 style="margin:0 0 10px">ğŸ¨ å¿ƒæƒ…è°ƒè‰²</h3>
      <p class="subline" style="margin:0 0 10px">æŠŠè¿™ä¸€å¤©ï¼Œæ¶‚æˆä½ å–œæ¬¢çš„é¢œè‰²ã€‚</p>
      <input class="slider" id="hue" type="range" min="0" max="360" value="320" />
    </section>

    <!-- Envelope letter -->
    <section class="card" aria-label="ç”Ÿæ—¥ä¿¡">
      <h3 style="margin:0 0 10px">ğŸ’Œ æ‰“å¼€è¿™å°åªå†™ç»™ä½ çš„ä¿¡</h3>
      <div class="envelope-wrap">
        <div class="envelope" id="envelope">
          <div class="base"></div>
          <div class="flap"></div>
          <div class="paper">
            <header>å†™ç»™ä½ ï¼š</header>
            <div class="content" id="letter"><span class="caret"></span></div>
            <footer>
              <div>From Â· <span id="from-name">ä½ çš„è±†è±†</span></div>
            </footer>
          </div>
        </div>
      </div>
      <p class="open-hint" id="open-hint">ç‚¹ä¸€ä¸‹ä¿¡å°å³å¯æ‰“å¼€ / å…³é—­</p>
    </section>

    <!-- Reasons grid -->
    <section class="card" aria-label="æˆ‘çˆ±ä½ ï¼ˆçš„ç†ç”±ï¼‰æ¸…å•">
      <h3 style="margin:0 0 10px">ğŸŒŸ ä½ å¾ˆæ£’çš„ 10 ä¸ªç†ç”±ï¼ˆåªæ˜¯å¼€ä¸ªå¤´ï¼‰</h3>
      <div class="grid">
        <div class="reason col-6"><h4>01 ä½ å¾ˆæ¸©æŸ”</h4><p>æ€»èƒ½æ›¿åˆ«äººç€æƒ³ï¼Œä¹Ÿè¯·å¤šæ›¿è‡ªå·±æƒ³æƒ³ã€‚</p></div>
        <div class="reason col-6"><h4>02 ä½ åœ¨åŠªåŠ›</h4><p>ä¸å£°ä¸å“åœ°å¾€å‰èµ°çš„ä½ ï¼ŒçœŸçš„å¾ˆäº†ä¸èµ·ã€‚</p></div>
        <div class="reason col-6"><h4>03 ä½ ä¼šå‘å…‰</h4><p>æƒ…ç»ªå¶å°”æœ‰äº‘ï¼Œä½†ä½ æœ¬èº«å°±æ˜¯å…‰ã€‚</p></div>
        <div class="reason col-6"><h4>04 ä½ è¢«éœ€è¦</h4><p>æœ‰äººæŠŠä½ æ”¾åœ¨å¿ƒå°–å„¿ä¸Šï¼Œæˆ‘å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p></div>
        <div class="reason col-6"><h4>05 ä½ å¾ˆçœŸè¯š</h4><p>åœ¨è¿™ä¸ªä¸–ç•Œï¼ŒçœŸè¯šæ°¸è¿œç¨€ç¼ºè€Œçè´µã€‚</p></div>
        <div class="reason col-6"><h4>06 ä½ å€¼å¾—å¿«ä¹</h4><p>ä¸æ˜¯å› ä¸ºå®Œæˆäº†ä»€ä¹ˆï¼Œè€Œä»…ä»…å› ä¸ºä½ æ˜¯ä½ ã€‚</p></div>
        <div class="reason col-6"><h4>07 ä½ å¾ˆå‹‡æ•¢</h4><p>ä½ å’Œè‡ªå·±çš„æƒ…ç»ªæ‰“è¿‡å¾ˆå¤šèƒœä»—ã€‚</p></div>
        <div class="reason col-6"><h4>08 ä½ ä¼šè¢«æŠ±ç´§</h4><p>éš¾è¿‡çš„æ—¶å€™ï¼Œè¯·å…è®¸è¢«çˆ±æ‹¥æŠ±ã€‚</p></div>
        <div class="reason col-6"><h4>09 ä½ åœ¨è¢«çœ‹è§</h4><p>ä½ çš„åŠªåŠ›ä¸å–„è‰¯ï¼Œä»æ¥æ²¡æœ‰è¢«å¿½ç•¥ã€‚</p></div>
        <div class="reason col-6"><h4>10 ä½ æœ‰æ— é™å¯èƒ½</h4><p>æ–°çš„ä¸€å²ï¼Œæ˜¯å´­æ–°çš„æ—…ç¨‹ã€‚</p></div>
      </div>
    </section>

    <!-- Wish machine & input -->
    <section class="grid" aria-label="æ„¿æœ› & éšæœºç¥ç¦">
      <div class="col-6">
        <div class="card wish-box">
          <h3 style="margin:0 0 10px">ğŸ éšæœºç¥ç¦æœº</h3>
          <div class="wish-output" id="wish-output">è½»ç‚¹ä¸‹é¢æŒ‰é’®ï¼Œæ”¶ä¸€æ¡æ¥è‡ªå®‡å®™çš„å¥½æ¶ˆæ¯</div>
          <button class="btn" id="btn-wish">æ¥ä¸€å¥ï¼</button>
        </div>
      </div>
      <div class="col-6">
        <div class="card">
          <h3 style="margin:0 0 10px">ğŸ“ æ‚„æ‚„è®¸ä¸ªæ„¿</h3>
          <p class="subline" style="margin:0 0 10px">æ„¿æœ›ä¼šè¢«å°æ˜Ÿæ˜Ÿå¦¥å–„ä¿å­˜ï¼ˆåªåœ¨ä½ çš„è®¾å¤‡é‡Œï¼‰ã€‚</p>
          <form id="wish-form">
            <label for="wish" class="tip">å†™ä¸‹ä»Šå¤©çš„æ„¿æœ›ï¼š</label>
            <input id="wish" name="wish" placeholder="æ„¿æˆ‘ä»¬éƒ½è¢«è¿™ä¸–ç•Œæ¸©æŸ”ä»¥å¾…" style="width:100%; padding:12px 14px; border-radius:12px; border:1px solid hsl(var(--hue) 30% 50% / .35); background:hsl(var(--hue) 30% 12% / .5); color:var(--txt);"/>
            <div style="height:10px"></div>
            <button class="btn" type="submit">è£…è¿›å°æ˜Ÿæ˜Ÿ âœ¨</button>
            <button type="button" class="btn secondary" id="btn-show-wishes">æŸ¥çœ‹å·²ä¿å­˜</button>
          </form>
          <div id="wish-list" class="tip" style="margin-top:10px; display:none;"></div>
        </div>
      </div>
    </section>

    <!-- Coupons -->
    <section class="card" aria-label="ç”Ÿæ—¥ä¸“å±ç¤¼åˆ¸">
      <h3 style="margin:0 0 10px">ğŸ« ç”Ÿæ—¥ä¸“å±ç¤¼åˆ¸ï¼ˆå¯å³åˆ»å…‘ç°ï¼‰</h3>
      <div class="grid">
        <div class="col-4">
          <div class="coupon" data-id="hug">
            <div class="stamp">å·²ä½¿ç”¨</div>
            <h5>ä¸è®²é“ç†æ‹¥æŠ±åˆ¸</h5>
            <p>æƒ…ç»ªæ¥æ—¶ï¼Œä¸éœ€è¦è§£é‡Šã€‚åªè¦æŠ±ä¸€æŠ±ã€‚</p>
            <button class="use-btn">ç°åœ¨å°±ç”¨</button>
          </div>
        </div>
        <div class="col-4">
          <div class="coupon" data-id="walk">
            <div class="stamp">å·²ä½¿ç”¨</div>
            <h5>å¤œé£æ•£æ­¥åˆ¸</h5>
            <p>ä¸€èµ·åœ¨åŸå¸‚é‡Œå¹å¹é£ï¼Œä»€ä¹ˆéƒ½ä¸è¯´ä¹Ÿå¾ˆå¥½ã€‚</p>
            <button class="use-btn">ç°åœ¨å°±ç”¨</button>
          </div>
        </div>
        <div class="col-4">
          <div class="coupon" data-id="drink">
            <div class="stamp">å·²ä½¿ç”¨</div>
            <h5>å¥¶èŒ¶åŠ çç åˆ¸</h5>
            <p>ä»Šæ—¥ä»½å°ç”œèœœï¼šä½ ç‚¹å•ï¼Œæˆ‘è¯·å®¢ã€‚</p>
            <button class="use-btn">ç°åœ¨å°±ç”¨</button>
          </div>
        </div>
      </div>
      <p class="tip" style="margin-top:8px">ç‚¹â€œç°åœ¨å°±ç”¨â€ä¼šç›–ç« å…¥è´¦ï¼ŒåŒæ—¶é£˜ä¸€ç‚¹å½©å¸¦ã€‚</p>
    </section>

    <footer>
      <div>Â© <span id="year"></span> Â· è¿™ä»½ç½‘é¡µç¤¼ç‰©ç”± <span id="from-foot">ä½ çš„æœ‹å‹</span> é€ç»™ä½ ã€‚æ„¿ä½ æ¯ä¸€å¤©éƒ½è¢«æ¸©æŸ”ä»¥å¾…ã€‚</div>
      <div style="margin-top:6px">ï¼ˆæŒ‰ç©ºæ ¼æ”¾çƒŸèŠ± Â· è½»ç‚¹å¡ç‰‡ä¹Ÿæœ‰å°æƒŠå–œï¼‰</div>
    </footer>
  </div>

  <script>
    // ======== ç®€æ˜“å¯ç¼–è¾‘ä¿¡æ¯ï¼ˆæ”¹æˆä½ ä»¬çš„åå­—ï¼‰ ========
    const TO = "äº²çˆ±çš„ä½ ";      // å¥¹çš„åå­—ï¼ˆå¯æ”¹ï¼‰
    const FROM = "ä½ çš„æœ‹å‹";     // ä½ çš„åå­—ï¼ˆå¯æ”¹ï¼‰

    // ======== Typing letter content ========
    const letterLines = [
      `äº²çˆ±çš„ ${TO}ï¼š`,
      "ç”Ÿæ—¥å¿«ä¹å‘€ï¼è¿™ä¸€å¹´ä½ è¾›è‹¦å•¦ã€‚",
      "è°¢è°¢ä½ ä¸€ç›´æ¸©æŸ”åœ°å¯¹å¾…ä¸–ç•Œï¼Œä¹Ÿè¯·å¥½å¥½å¯¹å¾…è‡ªå·±ã€‚",
      "å¶å°”ä½è½æ²¡å…³ç³»ï¼Œä½†åˆ«ä¸€ç›´ä½åœ¨é˜´å¤©é‡Œã€‚",
      "æˆ‘ä¼šåœ¨ä½ éœ€è¦çš„æ—¶å€™ï¼Œé€’ä¸Šçƒ­ä¹ä¹çš„æ‹¥æŠ±å’Œè€å¿ƒã€‚",
      "æ„¿æ–°çš„ä¸€å²ï¼Œç¡å‰æœ‰æœŸå¾…ï¼Œé†’æ¥æœ‰å…‰ã€‚",
      `æ°¸è¿œç«™åœ¨ä½ è¿™è¾¹çš„ ${FROM}ã€‚`
    ];

    // ======== Confetti engine ========
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    let W = canvas.width = window.innerWidth;
    let H = canvas.height = window.innerHeight;
    window.addEventListener('resize', () => { W = canvas.width = innerWidth; H = canvas.height = innerHeight; });

    const pieces = [];
    function spawnPiece(x = Math.random()*W, y = -10, burst=false) {
      const hue = +getComputedStyle(document.documentElement).getPropertyValue('--hue') || 320;
      pieces.push({
        x, y, r: Math.random()*7+3, vx: (Math.random()*2-1)*(burst?4:1.2), vy: Math.random()*1+ (burst?2.5:0.6),
        rot: Math.random()*Math.PI, vr: (Math.random()*0.2-0.1), color: `hsl(${hue + (Math.random()*60-30)},90%,${50+Math.random()*20}%)`, life: 180 + Math.random()*120
      });
    }
    function burst(x, y, count=80) { for (let i=0;i<count;i++) spawnPiece(x + (Math.random()*60-30), y + (Math.random()*40-20), true); }
    function gentleRain() { for (let i=0;i<12;i++) spawnPiece(); }

    let lastTime=0;
    function animate(t=0) {
      const dt = Math.min(32, t - lastTime); // cap dt for stability
      lastTime = t;
      ctx.clearRect(0,0,W,H);
      pieces.forEach((p,i) => {
        p.vy += 0.01; // gravity
        p.x += p.vx; p.y += p.vy; p.rot += p.vr; p.life -= dt*0.06;
        if (p.y > H+20 || p.x < -20 || p.x > W+20 || p.life <= 0) { pieces.splice(i,1); return; }
        ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.rot); ctx.globalAlpha = Math.max(0, Math.min(1, p.life/120));
        ctx.fillStyle = p.color; ctx.fillRect(-p.r, -p.r/2, p.r*2, p.r); ctx.restore();
      });
      requestAnimationFrame(animate);
    }
    animate();
    setInterval(gentleRain, 1200);

    // ======== Hero interactions ========
    document.getElementById('btn-surprise').addEventListener('click', () => {
      burst(innerWidth/2, 160, 120);
      document.querySelector('header.hero').classList.add('pulse');
      setTimeout(()=>document.querySelector('header.hero').classList.remove('pulse'), 600);
      document.getElementById('envelope').scrollIntoView({ behavior: 'smooth', block: 'center' });
    });
    document.getElementById('btn-fire').addEventListener('click', () => burst(innerWidth/2, innerHeight*0.3, 120));
    window.addEventListener('keydown', (e)=>{ if (e.code === 'Space') { e.preventDefault(); burst(innerWidth/2, innerHeight*0.35, 140); }});

    // ======== Color slider ========
    const hue = document.getElementById('hue');
    hue.addEventListener('input', (e)=>{
      document.documentElement.style.setProperty('--hue', e.target.value);
    });

    // ======== Letter open & typing ========
    const envelope = document.getElementById('envelope');
    const letterBox = document.getElementById('letter');
    const openHint = document.getElementById('open-hint');
    const fromName = document.getElementById('from-name');
    const fromFoot = document.getElementById('from-foot');
    fromName.textContent = FROM; fromFoot.textContent = FROM; document.title = `ğŸ‚ ${TO} Â· ç”Ÿæ—¥å¿«ä¹ï¼`;
    let typed = false;

    function typeLines(lines, el, speed=34) {
      typed = true; el.innerHTML = '';
      let i = 0, j = 0; const span = document.createElement('span'); span.className='caret'; el.appendChild(span);
      function type() {
        if (i >= lines.length) { span.classList.remove('caret'); return; }
        const line = lines[i];
        if (j <= line.length) {
          span.textContent = line.slice(0, j++);
          setTimeout(type, speed);
        } else {
          el.appendChild(document.createElement('br'));
          i++; j=0; setTimeout(type, speed*7);
        }
      }
      type();
    }

    envelope.addEventListener('click', () => {
      envelope.classList.toggle('open');
      if (envelope.classList.contains('open')) {
        burst(envelope.getBoundingClientRect().left + envelope.clientWidth/2, envelope.getBoundingClientRect().top + 40, 80);
        if (!typed) typeLines(letterLines, letterBox);
        openHint.textContent = 'å†æ¬¡ç‚¹å‡»å¯ä»¥æŠŠä¿¡æ”¶èµ·æ¥';
      } else {
        openHint.textContent = 'ç‚¹ä¸€ä¸‹ä¿¡å°å³å¯æ‰“å¼€ / å…³é—­';
      }
    });

    // ======== Wish machine ========
    const wishes = [
      'å®‡å®™å·å·ä¸ºä½ æ’å¥½äº†å°æƒŠå–œã€‚',
      'ä»Šå¤©çš„é£è¶…æ¸©æŸ”ï¼Œä¼šæŠŠå¥½è¿å¹åˆ°ä½ è€³è¾¹ã€‚',
      'æ‰€æœ‰çƒ­çˆ±ä¸å®‰å¿ƒæ­£åœ¨å‘ä½ é è¿‘ã€‚',
      'è¯·æŠŠå¿«ä¹æ”¾åœ¨ä¼˜å…ˆçº§ç¬¬ä¸€ä½ã€‚',
      'ä½ å·²ç»å¾ˆæ£’äº†ï¼Œåˆ«å†è‹›æ±‚è‡ªå·±å•¦ã€‚',
      'æ„¿ä½ çš„å¿ƒä¸€ç›´è¢«æŸ”è½¯åŒ…è£¹ã€‚',
      'ä½ å°±æ˜¯ç­”æ¡ˆï¼Œæ— éœ€å’Œä»»ä½•äººæ¯”è¾ƒã€‚',
      'èŠ±ä¼šå¼€ï¼Œé£ä¼šæ¥ï¼Œä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥ã€‚',
      'ä½ å€¼å¾—è¢«è®¤çœŸã€è¢«åçˆ±ã€è¢«åšå®šé€‰æ‹©ã€‚',
      'ä¸–ç•Œå¤šäº†ä½ ï¼ŒçœŸçš„æ›´å¯çˆ±äº†ã€‚'
    ];
    const btnWish = document.getElementById('btn-wish');
    const wishOut = document.getElementById('wish-output');
    btnWish.addEventListener('click', () => {
      const msg = wishes[Math.floor(Math.random()*wishes.length)];
      wishOut.textContent = msg; wishOut.classList.add('pulse'); setTimeout(()=>wishOut.classList.remove('pulse'), 500);
      burst(wishOut.getBoundingClientRect().left + wishOut.clientWidth/2, wishOut.getBoundingClientRect().top + 20, 60);
    });

    // ======== Wish saving (localStorage) ========
    const wishForm = document.getElementById('wish-form');
    const wishInput = document.getElementById('wish');
    const wishList = document.getElementById('wish-list');
    document.getElementById('btn-show-wishes').addEventListener('click', () => {
      const list = JSON.parse(localStorage.getItem('bd-wishes')||'[]');
      if (!list.length) { wishList.style.display='block'; wishList.textContent='ï¼ˆè¿˜æ²¡æœ‰ä¿å­˜çš„æ„¿æœ›ï¼‰'; return; }
      wishList.style.display='block';
      wishList.innerHTML = list.map((w,i)=>`<div>â­ï¸ ${i+1}. ${w}</div>`).join('');
    });
    wishForm.addEventListener('submit', (e)=>{
      e.preventDefault();
      const v = wishInput.value.trim(); if (!v) return;
      const list = JSON.parse(localStorage.getItem('bd-wishes')||'[]'); list.unshift(v); localStorage.setItem('bd-wishes', JSON.stringify(list));
      wishInput.value = ''; wishList.style.display='block'; wishList.innerHTML = list.map((w,i)=>`<div>â­ï¸ ${i+1}. ${w}</div>`).join('');
      burst(wishForm.getBoundingClientRect().left + wishForm.clientWidth/2, wishForm.getBoundingClientRect().top + 10, 80);
    });

    // ======== Coupons ========
    document.querySelectorAll('.coupon').forEach(card => {
      const id = card.dataset.id; const key = `coupon-${id}`;
      if (localStorage.getItem(key)==='used') card.classList.add('used');
      card.querySelector('.use-btn').addEventListener('click', () => {
        card.classList.add('used'); localStorage.setItem(key,'used');
        const r = card.getBoundingClientRect(); burst(r.left + r.width/2, r.top + 20, 90);
      });
      card.addEventListener('click', () => {
        const r = card.getBoundingClientRect(); burst(r.left + Math.random()*r.width, r.top + Math.random()*r.height, 28);
      });
    });

    // ======== Footer year ========
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
